{% extends "base.html" %}

{% block title %}Badezimmer Automatisierung - KI Smart Home{% endblock %}

{% block content %}
<div class="bathroom-automation">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
        <div>
            <h2>üöø Badezimmer Automatisierung</h2>
            <p class="subtitle">Intelligente Steuerung von Luftentfeuchter und Heizung</p>
        </div>
        <a href="/luftentfeuchten/analytics" class="btn btn-primary" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
            üìä Analytics & Lernsystem
        </a>
    </div>

    <!-- Anomalie-Alerts (falls vorhanden) -->
    <div class="card alert-card" id="alerts-card" style="display: none; background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%); border-left: 4px solid #f59e0b;">
        <div style="display: flex; justify-content: space-between; align-items: start;">
            <div style="flex: 1;">
                <h3 style="margin-top: 0;">‚ö†Ô∏è System-Warnungen</h3>
                <div id="alerts-content">
                    <!-- Wird per JavaScript gef√ºllt -->
                </div>
            </div>
            <button id="dismiss-alerts-btn" class="btn btn-sm" style="background: transparent; color: #92400e; border: 1px solid #d97706; padding: 4px 10px;">
                ‚úï Schlie√üen
            </button>
        </div>
    </div>

    <!-- Status Card -->
    <div class="card status-card">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
            <h3 style="margin: 0;">Aktueller Status</h3>
            <button id="preview-btn" class="btn btn-sm" style="background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%); color: white; padding: 6px 14px; font-size: 0.9em;">
                üëÅÔ∏è Live-Preview
            </button>
        </div>
        <div class="status-grid">
            <div class="status-item">
                <span class="status-icon" id="shower-status-icon">‚è∏Ô∏è</span>
                <div>
                    <div class="status-label">Dusche erkannt</div>
                    <div class="status-value" id="shower-status">Nein</div>
                </div>
            </div>
            <div class="status-item">
                <span class="status-icon" id="dehumidifier-status-icon">‚è∏Ô∏è</span>
                <div>
                    <div class="status-label">Luftentfeuchter</div>
                    <div class="status-value" id="dehumidifier-status">Aus</div>
                </div>
            </div>
            <div class="status-item">
                <span class="status-icon">üíß</span>
                <div>
                    <div class="status-label">Luftfeuchtigkeit</div>
                    <div class="status-value" id="current-humidity">--%</div>
                </div>
            </div>
            <div class="status-item">
                <span class="status-icon">üå°Ô∏è</span>
                <div>
                    <div class="status-label">Temperatur</div>
                    <div class="status-value" id="current-temperature">--¬∞C</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Live-Preview Modal -->
    <div id="preview-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <h3 style="margin: 0;">üëÅÔ∏è Live-Preview: Was w√ºrde das System jetzt tun?</h3>
                <button id="close-preview-btn" class="btn btn-sm" style="background: #e5e7eb; color: #374151;">‚úï</button>
            </div>
            <div id="preview-content">
                <!-- Wird per JavaScript gef√ºllt -->
            </div>
        </div>
    </div>

    <!-- Energie & Kosten Card -->
    <div class="card energy-card" id="energy-card">
        <h3>‚ö° Energie & Kosten (letzte 30 Tage)</h3>
        <div id="energy-stats-loading" style="text-align: center; padding: 20px; color: #6b7280;">
            Lade Statistiken...
        </div>
        <div id="energy-stats-content" style="display: none;">
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 15px;">
                <div class="stat-box">
                    <div class="stat-label">Laufzeit</div>
                    <div class="stat-value" id="energy-runtime">--h</div>
                </div>
                <div class="stat-box">
                    <div class="stat-label">Verbrauch</div>
                    <div class="stat-value" id="energy-kwh">-- kWh</div>
                </div>
                <div class="stat-box">
                    <div class="stat-label">Kosten</div>
                    <div class="stat-value" id="energy-cost">--‚Ç¨</div>
                </div>
                <div class="stat-box" style="background: linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%);">
                    <div class="stat-label">Ersparnis vs. 24/7</div>
                    <div class="stat-value" id="energy-savings" style="color: #065f46;">--%</div>
                </div>
            </div>
            <div style="font-size: 0.85em; color: #6b7280; padding: 10px; background: #f9fafb; border-radius: 4px;">
                <strong>‚ÑπÔ∏è Info:</strong> Berechnung basiert auf <span id="energy-events-count">0</span> Events.
                Pro Event: √ò <span id="energy-avg-runtime">0</span> Min Laufzeit, √ò <span id="energy-avg-cost">0</span>‚Ç¨ Kosten.
            </div>
        </div>
    </div>

    <!-- Live Sensor Values & Actuator Testing -->
    <div class="card" id="live-sensors-card" style="display: none;">
        <h3>üì° Live-Sensor-Werte & Aktoren-Test</h3>
        <p class="subtitle" style="margin-bottom: 20px;">Echtzeitwerte der konfigurierten Sensoren und Steuerung der Aktoren</p>

        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
            <!-- Humidity Sensor -->
            <div class="sensor-live-card" id="live-humidity-card" style="display: none;">
                <div class="sensor-header">
                    <span class="sensor-icon">üíß</span>
                    <span class="sensor-name" id="live-humidity-name">Luftfeuchtigkeit</span>
                </div>
                <div class="sensor-value" id="live-humidity-value">--%</div>
                <div class="sensor-meta" id="live-humidity-meta">Warte auf Daten...</div>
            </div>

            <!-- Temperature Sensor -->
            <div class="sensor-live-card" id="live-temp-card" style="display: none;">
                <div class="sensor-header">
                    <span class="sensor-icon">üå°Ô∏è</span>
                    <span class="sensor-name" id="live-temp-name">Temperatur</span>
                </div>
                <div class="sensor-value" id="live-temp-value">--¬∞C</div>
                <div class="sensor-meta" id="live-temp-meta">Warte auf Daten...</div>
            </div>

            <!-- Door Sensor -->
            <div class="sensor-live-card" id="live-door-card" style="display: none;">
                <div class="sensor-header">
                    <span class="sensor-icon" id="live-door-icon">üö™</span>
                    <span class="sensor-name" id="live-door-name">T√ºr-Sensor</span>
                </div>
                <div class="sensor-value" id="live-door-value">Unbekannt</div>
                <div class="sensor-meta" id="live-door-meta">Warte auf Daten...</div>
            </div>

            <!-- Window Sensor -->
            <div class="sensor-live-card" id="live-window-card" style="display: none;">
                <div class="sensor-header">
                    <span class="sensor-icon" id="live-window-icon">ü™ü</span>
                    <span class="sensor-name" id="live-window-name">Fenster-Sensor</span>
                </div>
                <div class="sensor-value" id="live-window-value">Unbekannt</div>
                <div class="sensor-meta" id="live-window-meta">Warte auf Daten...</div>
            </div>

            <!-- Motion Sensor -->
            <div class="sensor-live-card" id="live-motion-card" style="display: none;">
                <div class="sensor-header">
                    <span class="sensor-icon" id="live-motion-icon">üë§</span>
                    <span class="sensor-name" id="live-motion-name">Bewegung</span>
                </div>
                <div class="sensor-value" id="live-motion-value">Keine Bewegung</div>
                <div class="sensor-meta" id="live-motion-meta">Warte auf Daten...</div>
            </div>

            <!-- Dehumidifier Control -->
            <div class="sensor-live-card actuator-card" id="live-dehumidifier-card" style="display: none;">
                <div class="sensor-header">
                    <span class="sensor-icon" id="live-dehumidifier-icon">üí®</span>
                    <span class="sensor-name" id="live-dehumidifier-name">Luftentfeuchter</span>
                </div>
                <div class="sensor-value" id="live-dehumidifier-value">Aus</div>
                <div style="margin-top: 15px;">
                    <button class="btn btn-sm btn-test" id="test-dehumidifier-on">‚ñ∂Ô∏è Ein</button>
                    <button class="btn btn-sm btn-test" id="test-dehumidifier-off" style="margin-left: 8px;">‚è∏Ô∏è Aus</button>
                </div>
                <div class="sensor-meta" id="live-dehumidifier-meta">Warte auf Daten...</div>
            </div>

            <!-- Heater Control -->
            <div class="sensor-live-card actuator-card" id="live-heater-card" style="display: none;">
                <div class="sensor-header">
                    <span class="sensor-icon" id="live-heater-icon">üî•</span>
                    <span class="sensor-name" id="live-heater-name">Heizung</span>
                </div>
                <div class="sensor-value" id="live-heater-value">--¬∞C</div>
                <div style="margin-top: 15px;">
                    <button class="btn btn-sm btn-test" id="test-heater-up">‚¨ÜÔ∏è +1¬∞C</button>
                    <button class="btn btn-sm btn-test" id="test-heater-down" style="margin-left: 8px;">‚¨áÔ∏è -1¬∞C</button>
                </div>
                <div class="sensor-meta" id="live-heater-meta">Warte auf Daten...</div>
            </div>
        </div>

        <div style="margin-top: 20px; padding: 12px; background: #eff6ff; border-left: 4px solid #3b82f6; border-radius: 4px;">
            <small style="color: #1e40af;">
                ‚ÑπÔ∏è Aktualisiert alle 5 Sekunden. Aktoren-Tests schalten Ger√§te direkt - verwenden Sie diese Funktion vorsichtig!
            </small>
        </div>
    </div>

    <!-- Konfiguration -->
    <div class="card config-card">
        <h3>‚öôÔ∏è Konfiguration</h3>

        <!-- Aktivierungs-Toggle hervorgehoben -->
        <div class="enable-section" style="background: linear-gradient(135deg, #667eea15 0%, #764ba215 100%); border: 2px solid #667eea; border-radius: 8px; padding: 20px; margin-bottom: 30px;">
            <label class="toggle-label" style="display: flex; align-items: center; gap: 15px; cursor: pointer; margin: 0;">
                <input type="checkbox" id="bathroom-enabled" class="toggle-checkbox">
                <span class="toggle-switch"></span>
                <div style="flex: 1;">
                    <div style="font-size: 16px; font-weight: 600; color: #1f2937; margin-bottom: 4px;">
                        Badezimmer-Automatisierung aktivieren
                    </div>
                    <div style="font-size: 13px; color: #6b7280;">
                        Aktiviert die automatische Steuerung basierend auf Luftfeuchtigkeit
                    </div>
                </div>
            </label>
        </div>

        <!-- Tab Navigation -->
        <div class="config-tabs">
            <button class="tab-btn active" data-tab="devices">üîå Ger√§te zuweisen</button>
            <button class="tab-btn" data-tab="thresholds">üìè Schwellwerte</button>
            <button class="tab-btn" data-tab="heating">üî• Heizung</button>
            <button class="tab-btn" data-tab="advanced">‚öôÔ∏è Erweitert</button>
        </div>

        <!-- Tab Content: Ger√§te -->
        <div class="tab-content active" id="tab-devices">
            <div class="form-section">
                <div class="form-group">
                    <label>Raum ausw√§hlen</label>
                    <select id="room-filter" class="form-select">
                        <option value="">-- Alle R√§ume --</option>
                    </select>
                    <small style="color: #6b7280; margin-top: 4px; display: block;">
                        W√§hlen Sie einen Raum aus, um nur Ger√§te aus diesem Raum anzuzeigen
                    </small>
                </div>

                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 15px; margin-top: 20px;">
                    <div class="form-group">
                        <label>Luftfeuchtigkeit-Sensor *</label>
                        <select id="humidity-sensor" class="form-select">
                            <option value="">-- Sensor ausw√§hlen --</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>Temperatur-Sensor *</label>
                        <select id="temperature-sensor" class="form-select">
                            <option value="">-- Sensor ausw√§hlen --</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>Luftentfeuchter *</label>
                        <select id="dehumidifier" class="form-select">
                            <option value="">-- Ger√§t ausw√§hlen --</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>Heizung/Thermostat</label>
                        <select id="heater" class="form-select">
                            <option value="">-- Optional --</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>Bewegungssensor (Optional)</label>
                        <select id="motion-sensor" class="form-select">
                            <option value="">-- Optional --</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>T√ºr-Sensor (Optional)</label>
                        <select id="door-sensor" class="form-select">
                            <option value="">-- Optional --</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>Fenster-Sensor (Empfohlen) ‚ö†Ô∏è</label>
                        <select id="window-sensor" class="form-select">
                            <option value="">-- Optional --</option>
                        </select>
                        <small style="color: #d97706; margin-top: 4px; display: block; font-weight: 500;">
                            ‚ö†Ô∏è Bei offenem Fenster: Heizung + Luftentfeuchter werden deaktiviert
                        </small>
                    </div>
                </div>

                <div style="background: #eff6ff; border-left: 4px solid #3b82f6; border-radius: 6px; padding: 12px; margin-top: 20px;">
                    <small style="color: #1e40af;">
                        <strong>üí° Tipp:</strong> Pflichtfelder (*) m√ºssen ausgef√ºllt werden. Optionale Sensoren verbessern die Genauigkeit.
                    </small>
                </div>

                <div style="background: #fef3c7; border-left: 4px solid #f59e0b; border-radius: 6px; padding: 12px; margin-top: 15px;">
                    <small style="color: #92400e;">
                        <strong>‚ö†Ô∏è Wichtig:</strong> Der <strong>Fenster-Sensor</strong> ist dringend empfohlen!
                        Bei offenem Fenster werden Heizung und Luftentfeuchter automatisch deaktiviert,
                        um Energieverschwendung zu vermeiden und nat√ºrliche L√ºftung zu nutzen.
                    </small>
                </div>
            </div>
        </div>

        <!-- Tab Content: Schwellwerte -->
        <div class="tab-content" id="tab-thresholds">
            <div class="form-section">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                    <div id="learning-status-badge" style="display: none;">
                        <!-- Wird per JavaScript gef√ºllt -->
                </div>
            </div>

            <!-- Info-Box f√ºr selbstlernendes System -->
            <div id="learning-info-box" style="display: none; background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%); border-left: 4px solid #3b82f6; border-radius: 6px; padding: 15px; margin-bottom: 20px;">
                <div style="display: flex; align-items: start; gap: 12px;">
                    <span style="font-size: 1.5em;">üß†</span>
                    <div style="flex: 1;">
                        <div style="font-weight: 600; color: #1e40af; margin-bottom: 6px;">Selbstlernendes System aktiv</div>
                        <div style="font-size: 0.9em; color: #1e40af; margin-bottom: 8px;" id="learning-info-text">
                            <!-- Wird per JavaScript gef√ºllt -->
                        </div>
                        <button id="reset-learned-btn" class="btn btn-sm" style="background: #ef4444; color: white; padding: 4px 12px; font-size: 0.85em; margin-top: 4px;">
                            üîÑ Gelernte Werte zur√ºcksetzen
                        </button>
                    </div>
                </div>
            </div>

            <div class="form-group">
                <label>
                    Hohe Luftfeuchtigkeit (Luftentfeuchter EIN)
                    <span id="humidity-high-source" class="param-source-badge" style="display: none;">
                        <!-- Wird per JavaScript gef√ºllt -->
                    </span>
                </label>
                <div class="slider-group">
                    <input type="range" id="humidity-high" min="50" max="90" value="70" class="slider">
                    <span class="slider-value" id="humidity-high-value">70%</span>
                </div>
                <small id="humidity-high-learned-info" class="learned-param-info" style="display: none; color: #3b82f6; margin-top: 4px;">
                    <!-- Wird per JavaScript gef√ºllt -->
                </small>
            </div>

            <div class="form-group">
                <label>
                    Niedrige Luftfeuchtigkeit (Luftentfeuchter AUS)
                    <span id="humidity-low-source" class="param-source-badge" style="display: none;">
                        <!-- Wird per JavaScript gef√ºllt -->
                    </span>
                </label>
                <div class="slider-group">
                    <input type="range" id="humidity-low" min="40" max="80" value="60" class="slider">
                    <span class="slider-value" id="humidity-low-value">60%</span>
                </div>
                <small id="humidity-low-learned-info" class="learned-param-info" style="display: none; color: #3b82f6; margin-top: 4px;">
                    <!-- Wird per JavaScript gef√ºllt -->
                </small>
            </div>

            <div class="form-group">
                <label>
                    Verz√∂gerung vor Ausschalten (Minuten)
                    <span id="delay-source" class="param-source-badge" style="display: none;">
                        <!-- Wird per JavaScript gef√ºllt -->
                    </span>
                </label>
                <div class="slider-group">
                    <input type="range" id="dehumidifier-delay" min="0" max="30" value="5" class="slider">
                    <span class="slider-value" id="dehumidifier-delay-value">5 Min</span>
                </div>
                <small id="delay-learned-info" class="learned-param-info" style="display: none; color: #3b82f6; margin-top: 4px;">
                    <!-- Wird per JavaScript gef√ºllt -->
                </small>
            </div>
            </div>
        </div>

        <!-- Tab Content: Heizung -->
        <div class="tab-content" id="tab-heating">
            <div class="form-section">
                <h4>üî• Heizungssteuerung</h4>
                <p style="color: #6b7280; font-size: 0.9em; margin-bottom: 20px;">
                    Konfigurieren Sie die intelligente Heizungssteuerung f√ºr optimalen Komfort w√§hrend der Badezimmer-Nutzung.
                </p>

                <div class="form-group">
                    <label>Ziel-Temperatur (Normal)</label>
                    <div class="slider-group">
                        <input type="range" id="target-temperature" min="18" max="26" value="22" step="0.5" class="slider">
                        <span class="slider-value" id="target-temperature-value">22¬∞C</span>
                    </div>
                    <small style="color: #6b7280; margin-top: 4px; display: block;">
                        Gew√ºnschte Temperatur im Badezimmer unter normalen Bedingungen
                    </small>
                </div>

                <div class="form-group">
                    <label class="toggle-label" style="display: flex; align-items: center; gap: 15px; cursor: pointer;">
                        <input type="checkbox" id="heating-boost-enabled" class="toggle-checkbox" checked>
                        <span class="toggle-switch"></span>
                        <div style="flex: 1;">
                            <div style="font-weight: 600; color: #1f2937;">Heizungs-Boost w√§hrend Entfeuchtung</div>
                            <div style="font-size: 0.85em; color: #6b7280; margin-top: 2px;">
                                Erh√∂ht Temperatur um +1¬∞C w√§hrend Luftentfeuchter l√§uft (beschleunigt Trocknung)
                            </div>
                        </div>
                    </label>
                </div>

                <div class="form-group" id="boost-temp-group">
                    <label>Temperatur-Erh√∂hung w√§hrend Entfeuchtung</label>
                    <div class="slider-group">
                        <input type="range" id="heating-boost-delta" min="0" max="3" value="1" step="0.5" class="slider">
                        <span class="slider-value" id="heating-boost-delta-value">+1¬∞C</span>
                    </div>
                    <small style="color: #6b7280; margin-top: 4px; display: block;">
                        Wie viel w√§rmer soll es sein, wenn der Luftentfeuchter l√§uft?
                    </small>
                </div>

                <div style="background: #eff6ff; border-left: 4px solid #3b82f6; border-radius: 6px; padding: 12px; margin-top: 20px;">
                    <small style="color: #1e40af;">
                        <strong>üí° Tipp:</strong> H√∂here Temperaturen beschleunigen die Trocknung, verbrauchen aber mehr Energie.
                        Der Boost ist optional und kann deaktiviert werden.
                    </small>
                </div>

                <div style="background: #fef3c7; border-left: 4px solid #f59e0b; border-radius: 6px; padding: 12px; margin-top: 15px;">
                    <small style="color: #92400e;">
                        <strong>‚ö†Ô∏è Sicherheit:</strong> Bei offenem Fenster wird die Heizung automatisch deaktiviert,
                        unabh√§ngig von diesen Einstellungen.
                    </small>
                </div>
            </div>
        </div>

        <!-- Tab Content: Erweitert -->
        <div class="tab-content" id="tab-advanced">
            <div class="form-section">
                <h4>Energie-Berechnung</h4>
                <p style="color: #6b7280; font-size: 0.9em; margin-bottom: 15px;">
                    Diese Werte werden f√ºr die Energie- und Kostenberechnung des Luftentfeuchters verwendet.
                </p>

                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px;">
                    <div class="form-group">
                        <label>Luftentfeuchter Leistung (Watt)</label>
                        <input type="number" id="dehumidifier-wattage" class="form-input" value="400" min="100" max="2000" step="50">
                        <small style="color: #6b7280; margin-top: 4px; display: block;">
                            Typische Werte: 300-600W<br>
                            Pr√ºfen Sie das Typenschild Ihres Ger√§ts
                        </small>
                    </div>

                    <div class="form-group">
                        <label>Strompreis (‚Ç¨/kWh)</label>
                        <input type="number" id="energy-price" class="form-input" value="0.30" min="0.01" max="1.00" step="0.01">
                        <small style="color: #6b7280; margin-top: 4px; display: block;">
                            Durchschnitt Deutschland: 0.30-0.40‚Ç¨/kWh<br>
                            Siehe Ihre Stromrechnung
                        </small>
                    </div>
                </div>

                <div style="background: #eff6ff; border-left: 4px solid #3b82f6; border-radius: 6px; padding: 12px; margin-top: 20px;">
                    <small style="color: #1e40af;">
                        <strong>‚ÑπÔ∏è Hinweis:</strong> Die Heizung (Zentralheizung) wird nicht in die Berechnung einbezogen,
                        da diese nicht direkt gemessen werden kann. Die Kosten beziehen sich nur auf den Luftentfeuchter.
                    </small>
                </div>

                <div style="background: #fef3c7; border-left: 4px solid #f59e0b; border-radius: 6px; padding: 12px; margin-top: 15px;">
                    <small style="color: #92400e;">
                        <strong>üí° Tipp:</strong> Bei √§lteren Luftentfeuchtern kann die Leistungsaufnahme h√∂her sein.
                        Moderne Ger√§te mit Kompressor liegen meist bei 300-400W.
                    </small>
                </div>
            </div>
        </div>

        <div class="form-actions" style="margin-top: 30px; padding-top: 20px; border-top: 2px solid #e5e7eb;">
            <button id="save-bathroom-config" class="btn btn-primary">üíæ Konfiguration speichern</button>
            <button id="test-bathroom" class="btn btn-secondary">üß™ Test ausf√ºhren</button>
        </div>
    </div>

    <!-- Erkl√§rung -->
    <div class="card info-card">
        <h3>‚ÑπÔ∏è Wie funktioniert's?</h3>
        <div class="info-content">
            <div class="info-item">
                <strong>üöø Duschen-Erkennung:</strong>
                <p>Das System erkennt automatisch, wenn geduscht wird: Luftfeuchtigkeit steigt √ºber den eingestellten Schwellwert (Standard: 70%)</p>
            </div>
            <div class="info-item">
                <strong>üí® Luftentfeuchter-Steuerung:</strong>
                <p>Schaltet automatisch EIN wenn Luftfeuchtigkeit zu hoch ist, und AUS wenn sie wieder normal ist (Standard: 60%)</p>
            </div>
            <div class="info-item">
                <strong>‚è±Ô∏è Intelligente Verz√∂gerung:</strong>
                <p>Nach der letzten Bewegung wartet das System 5 Minuten bevor der Luftentfeuchter ausgeschaltet wird</p>
            </div>
            <div class="info-item">
                <strong>üå°Ô∏è Heizungs-Optimierung:</strong>
                <p>W√§hrend der Entfeuchtung wird die Heizung um 1¬∞C erh√∂ht, um die Trocknung zu beschleunigen</p>
            </div>
        </div>
    </div>
</div>

<style>
.sensor-live-card {
    background: white;
    border-radius: 8px;
    padding: 20px;
    box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    border: 2px solid #e5e7eb;
    transition: all 0.3s ease;
}

.sensor-live-card:hover {
    border-color: #3b82f6;
    box-shadow: 0 4px 6px rgba(0,0,0,0.1);
}

.actuator-card {
    border-color: #fbbf24;
    background: linear-gradient(135deg, #ffffff 0%, #fef3c715 100%);
}

.actuator-card:hover {
    border-color: #f59e0b;
}

.sensor-header {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-bottom: 15px;
}

.sensor-icon {
    font-size: 1.8em;
}

.sensor-name {
    font-weight: 600;
    color: #1f2937;
    font-size: 1.05em;
}

.sensor-value {
    font-size: 2em;
    font-weight: bold;
    color: #1f2937;
    margin: 10px 0;
}

.sensor-meta {
    font-size: 0.85em;
    color: #6b7280;
    margin-top: 8px;
}

.btn-sm {
    padding: 6px 12px;
    font-size: 0.85em;
}

.btn-test {
    background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
    color: white;
    border: none;
    cursor: pointer;
    transition: all 0.2s ease;
}

.btn-test:hover {
    background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%);
    transform: translateY(-2px);
    box-shadow: 0 4px 6px rgba(0,0,0,0.15);
}

.btn-test:active {
    transform: translateY(0);
}

.btn-test:disabled {
    opacity: 0.5;
    cursor: not-allowed;
}

/* Status indicators for door/motion */
.sensor-value.door-open {
    color: #ef4444;
}

.sensor-value.door-closed {
    color: #10b981;
}

.sensor-value.motion-detected {
    color: #f59e0b;
    animation: pulse 1.5s ease-in-out infinite;
}

@keyframes pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.6; }
}

/* Gelernte Parameter Styles */
.param-source-badge {
    font-size: 0.75em;
    padding: 2px 8px;
    border-radius: 12px;
    margin-left: 8px;
    font-weight: 600;
}

.param-source-badge.learned {
    background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
    color: white;
}

.param-source-badge.manual {
    background: #e5e7eb;
    color: #6b7280;
}

.learned-param-info {
    display: block;
    font-size: 0.85em;
}

#learning-status-badge {
    padding: 6px 14px;
    border-radius: 16px;
    font-size: 0.85em;
    font-weight: 600;
}

#learning-status-badge.active {
    background: linear-gradient(135deg, #10b981 0%, #059669 100%);
    color: white;
}

#learning-status-badge.inactive {
    background: #e5e7eb;
    color: #6b7280;
}

/* Energie & Kosten Stats */
.stat-box {
    background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%);
    padding: 15px;
    border-radius: 8px;
    text-align: center;
}

.stat-label {
    font-size: 0.85em;
    color: #6b7280;
    margin-bottom: 5px;
}

.stat-value {
    font-size: 1.6em;
    font-weight: bold;
    color: #1f2937;
}

/* Modal Styles */
.modal {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.5);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 1000;
}

.modal-content {
    background: white;
    border-radius: 12px;
    padding: 25px;
    max-width: 600px;
    width: 90%;
    max-height: 80vh;
    overflow-y: auto;
    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
}

/* Preview Styles */
.preview-section {
    margin-bottom: 20px;
    padding: 15px;
    background: #f9fafb;
    border-radius: 8px;
    border-left: 4px solid #3b82f6;
}

.preview-section h4 {
    margin: 0 0 10px 0;
    color: #1f2937;
    font-size: 1.05em;
}

.preview-action {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 10px;
    background: white;
    border-radius: 6px;
    margin-bottom: 8px;
}

.preview-action.turn-on {
    border-left: 4px solid #10b981;
}

.preview-action.turn-off {
    border-left: 4px solid #ef4444;
}

.preview-action.no-change {
    border-left: 4px solid #6b7280;
}

/* Alert Styles */
.alert-item {
    padding: 12px;
    background: white;
    border-radius: 6px;
    margin-bottom: 10px;
    border-left: 4px solid #f59e0b;
}

.alert-item.severity-high {
    border-left-color: #ef4444;
    background: #fef2f2;
}

.alert-item.severity-medium {
    border-left-color: #f59e0b;
    background: #fffbeb;
}

.alert-item.severity-low {
    border-left-color: #3b82f6;
    background: #eff6ff;
}

.alert-title {
    font-weight: 600;
    margin-bottom: 4px;
    color: #1f2937;
}

.alert-message {
    font-size: 0.9em;
    color: #4b5563;
}

/* Tab System */
.config-tabs {
    display: flex;
    gap: 5px;
    margin-bottom: 25px;
    border-bottom: 2px solid #e5e7eb;
}

.tab-btn {
    background: transparent;
    border: none;
    padding: 12px 20px;
    font-size: 0.95em;
    font-weight: 500;
    color: #6b7280;
    cursor: pointer;
    border-bottom: 3px solid transparent;
    transition: all 0.2s ease;
    position: relative;
    bottom: -2px;
}

.tab-btn:hover {
    color: #3b82f6;
    background: #eff6ff;
}

.tab-btn.active {
    color: #3b82f6;
    border-bottom-color: #3b82f6;
    font-weight: 600;
}

.tab-content {
    display: none;
}

.tab-content.active {
    display: block;
    animation: fadeIn 0.3s ease;
}

@keyframes fadeIn {
    from { opacity: 0; transform: translateY(-10px); }
    to { opacity: 1; transform: translateY(0); }
}

.form-input {
    width: 100%;
    padding: 8px 12px;
    border: 1px solid #d1d5db;
    border-radius: 6px;
    font-size: 0.95em;
    transition: border-color 0.2s ease;
}

.form-input:focus {
    outline: none;
    border-color: #3b82f6;
    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
}
</style>

<script src="{{ url_for('static', filename='js/luftentfeuchten.js') }}"></script>
{% endblock %}
